<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--
<meta http-equiv="refresh" content="0; url=http://www.flcbranson.org/liveapp">
-->
<title>FLC Live</title>
<style>
body { margin:0; padding:0; }
/* height:auto and height:100% don't change height for iOS and it puts the controls below the screen bottom for computers and Android */
video { position:absolute; top:0; left:0; right:0; width:100%; height:100%; }
</style>
<script>
function fetchJSONFile(path, callback) {
	var httpRequest = new XMLHttpRequest();
	httpRequest.onreadystatechange = function() {
		if (httpRequest.readyState === 4) {
			if (httpRequest.status === 200) {
				var data = JSON.parse(httpRequest.responseText);
				if (callback) callback(data);
			}
		}
	};
	httpRequest.open('GET', path);
	httpRequest.send(); 
}
// this requires the file and executes a callback with the parsed result once it is available
fetchJSONFile('http://www.flcbranson.org/api/livebroadcast', function(data){
	// do something with your data
	// alert(JSON.stringify(data));
	// alert(data.datetime + ', ' + data.status);
	if (data.status == 'off') {
		// Wait for Cordova to load
		document.addEventListener("deviceready", onDeviceReady, false);
		// Cordova is ready
		function onDeviceReady() {
			// open URL in default web browser
			var ref = window.open(encodeURI('http://www.flcbranson.org'), '_system', 'location=yes');
		}
	} else if (data.status == 'flcb' || data.status == 'flcs') {
		window.location = "http://www.flcbranson.org/liveapp";
	} else {
		document.write('<p>It seems that an error has occurred with our live broadcast <abbr title="Application Programming Interface">API</abbr>.  Please contact support through our <a href="flcsupport@moorelife.org">support e-mail address</a> or <a href="tel:+1-417-334-9233">phone number</a>.</p>');
	}
});
</script>
</head>
<body>
<script src="phonegap.js"></script>
<script>
app.initialize();
</script>
</body>
</html>